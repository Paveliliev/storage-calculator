<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Storage Zone Optimizer</title>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css" />
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
</head>
<body style="background-color: #f4f4f9; font-family: 'Segoe UI', sans-serif; padding: 20px;">

    <section style="text-align: center;">
        <div style="background: white; display: inline-block; padding: 30px; border-radius: 15px; border: 1px solid #ddd; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 500px;">
            <h1 style="color: #2c3e50; margin-bottom: 5px;">Storage Zone Optimizer</h1>
            
            <div style="margin-bottom: 20px; font-size: 0.8em; color: #555; background: #fff9e6; padding: 10px; border-radius: 8px; border: 1px dashed #f39c12;">
                <strong>Max Storage Capacity (LxWxH):</strong><br>
                Limit: 60 x 40 x 35
            </div>

            <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">
                <input type="number" id="L" placeholder="Length" style="width: 80px; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"/>
                <input type="number" id="W" placeholder="Width" style="width: 80px; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"/>
                <input type="number" id="H" placeholder="Height" style="width: 80px; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"/>
            </div>

            <button id="calc-btn" py-click="calc" style="width: 100%; padding: 12px; background-color: #2c3e50; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1em;">
                Analyze Storage Fit
            </button>

            <div id="output-area" style="margin-top: 25px; text-align: left; min-height: 50px;"></div>
        </div>
    </section>

    <script type="py">
from pyscript import document
import math

def calc(event):
    output_div = document.querySelector("#output-area")
    val_l = document.querySelector("#L").value
    val_w = document.querySelector("#W").value
    val_h = document.querySelector("#H").value

    output_div.innerHTML = ""

    if not val_l or not val_w or not val_h:
        output_div.innerHTML = "<div style='color: #c0392b; background: #fceae9; padding: 10px; border-radius: 5px; border: 1px solid #e74c3c;'><strong>‚ö†Ô∏è Missing Data:</strong> Please enter dimensions!</div>"
        return

    try:
        L = max(float(val_l), float(val_w))
        W = min(float(val_l), float(val_w))
        H = float(val_h)

        if L > 60 or W > 40 or H > 35:
            output_div.innerHTML = "<div style='color: #c0392b; background: #fceae9; padding: 10px; border-radius: 5px; border: 1px solid #e74c3c;'><strong>üö´ Cannot Store:</strong> Material exceeds 60x40x35 limit.</div>"
            return

        # 1. Standard Bin Dimensions
        bins = {
            "SH": {"l": 52, "w": 32, "h": 30},
            "OC": {"l": 51.5, "w": 33.5, "h": 34},
            "CL": {"l": 238, "w": 41.5, "h": 36}
        }

        # 2. Raw Calculations
        res_sh = math.floor(bins["SH"]["l"]/L) * math.floor(bins["SH"]["w"]/W) * math.floor(bins["SH"]["h"]/H)
        res_oc = math.floor(bins["OC"]["l"]/L) * math.floor(bins["OC"]["w"]/W) * math.floor(bins["OC"]["h"]/H) * 2
        res_cl = math.floor(bins["CL"]["l"]/L) * math.floor(bins["CL"]["w"]/W) * math.floor(bins["CL"]["h"]/H)

        # 3. Weighted Comparison
        comparison = {"SH": res_sh * 6, "CL": res_cl, "OC": res_oc * 2}
        ideal_zone = max(comparison, key=comparison.get)
        
        raw_map = {"SH": res_sh, "CL": res_cl, "OC": res_oc}
        ideal_qty = raw_map[ideal_zone]

        # 4. Volume Utilization %
        # Formula: (Total Item Volume / Total Bin Volume) * 100
        item_vol = (L * W * H) * ideal_qty
        bin_dims = bins[ideal_zone]
        bin_vol = bin_dims["l"] * bin_dims["w"] * bin_dims["h"]
        # Adjusted for OC double-bin logic if necessary
        if ideal_zone == "OC": bin_vol *= 2 
        
        utilization = (item_vol / bin_vol) * 100

        html_report = f"""
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #2c3e50;">
                <p style="margin: 5px 0;"> SH Capacity: <strong>{res_sh}</strong></p>
                <p style="margin: 5px 0;"> OC Capacity: <strong>{res_oc}</strong></p>
                <p style="margin: 5px 0;"> CL Capacity: <strong>{res_cl}</strong></p>
            </div>
            <div style="margin-top: 15px; padding: 15px; background-color: #eafaf1; border-radius: 8px; border: 1px solid #27ae60;">
                <div style="color: #27ae60; font-weight: bold; font-size: 1.1em; margin-bottom: 5px;">
                    ‚úÖ IDEAL ZONE: {ideal_zone} ({ideal_qty} units)
                </div>
                <div style="font-size: 0.9em; color: #2c3e50;">
                    Volume Utilization: <strong>{utilization:.1f}%</strong>
                </div>
                <div style="width: 100%; background: #ddd; height: 8px; border-radius: 4px; margin-top: 8px;">
                    <div style="width: {min(utilization, 100):.1f}%; background: #27ae60; height: 100%; border-radius: 4px;"></div>
                </div>
            </div>
        """
        output_div.innerHTML = html_report

    except Exception as e:
        output_div.innerHTML = f"<div style='color: #c0392b;'><strong>System Error:</strong> {str(e)}</div>"
    </script>

</body>
</html>